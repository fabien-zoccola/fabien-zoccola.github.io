import{W as e,h as t,i as r}from"./index-fe8be053.js";class n extends e{static get converter(){}constructor(e,t){super(e,t),this.container=null,this.observe=null}connected(){super.connected(),setTimeout((()=>this.initConverter()))}initConverter(){if(this.ref!==this.host)return;const{host:e}=this,t=this.ref=e.querySelector("textarea, pre");if(e.nuIsShadowAllowed?e.attachShadow({mode:"open"}):this.setMod("host",!0),!t)return;e.nuRef=t,t.setAttribute("role","none"),t.setAttribute("aria-hidden","true");const r=this.requireContainer(),n=this.observe=this.createObserveListener(t,r,this.constructor.converter);new MutationObserver((()=>n())).observe(t,{characterData:!1,attributes:!1,childList:!0,subtree:!1}),n()}requireContainer(){const{host:e}=this;this.container=this.createContainer();return e.nuQueryChildren("*:not(pre):not(textarea)").forEach((e=>{e.parentNode.removeChild(e)})),(e.nuShadow||e).appendChild(this.container),this.container}createContainer(){return t("nu-block")}createObserveListener(e,t,r){return()=>{const n=this.prepareContent("TEXTAREA"===e.tagName?e.textContent:e.innerHTML);this.apply(t,n,r),this.postHandler(t)}}setValue(e,t){if(this.log("set value",e,t),"string"!=typeof e)return;if(r(this.value,e))return;this.value=e;const n=this.requireContainer(),s=this.prepareContent(e);this.apply(n,s,this.constructor.converter),this.postHandler(n)}apply(e,t,r){}prepareContent(e){return e||""}postHandler(e){}}export{n as C};
